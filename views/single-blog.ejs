<html lang="en">
  <%- include("./partials/head.ejs") %>

  <body>
    <%- include("./partials/nav.ejs") %>

    <div class="single-blog">
      <h1 class="blog-title"><%= blog.title %></h1>
      <p class="blog-author">By <%= blog.author %> on <%= blog.updatedAt %></p>
      <p class="blog-summary"><%= blog.summary %></p>
      <div class="blog-content">
        <p><%= blog.content %></p>
      </div>
      <button id="delete-button" data-docid="<%= blog.id %>">
        Delete Blog
      </button>
      <a class="back-link" href="/blogs">Back to Blog List</a>
    </div>

    <%- include("./partials/footer.ejs") %>
    <script>
      const deleteButton = document.getElementById("delete-button");
      deleteButton.addEventListener("click", async () => {
        const deleteEndpoint = `/blogs/id/${deleteButton.dataset.docid}`;
        console.log(`deleteEndpoint: ${deleteEndpoint}`);
        const response = await fetch(deleteEndpoint, {
          method: "DELETE",
        });
        if (response.ok) {
          responseContent = await response.json();
          console.log(response);
          window.location.href = responseContent.redirect;
        } else {
          alert("Failed to delete blog");
        }
      });
    </script>
  </body>
</html>
